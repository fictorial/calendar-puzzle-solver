const PF = [
  [
    [
      [1, 1, 1, 1],
      [0, 0, 0, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 1, 1],
      [1, 0, 0, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 0, 0, 1],
      [1, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 1, 0, 0],
    ],
  ],
  [
    [
      [1, 1, 1, 1],
      [0, 1, 0, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [1, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
    ],
    [
      [1, 1, 1, 1],
      [0, 0, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 0, 1, 0],
      [1, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
    ],
  ],
  [
    [
      [1, 1, 1, 0],
      [0, 0, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [0, 1, 1, 1],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
    ],
    [
      [0, 1, 1, 1],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 0, 1, 1],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
    ],
  ],
  [
    [
      [1, 1, 1, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
  ],
  [
    [
      [1, 0, 1, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 1, 0],
      [1, 0, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
  ],
  [
    [
      [1, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 0, 1, 0],
      [1, 1, 1, 0],
      [1, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 1, 0],
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
    ],
  ],
  [
    [
      [1, 0, 0, 0],
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 1, 1, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 1, 0],
      [1, 1, 0, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 1, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
      [0, 0, 0, 0],
    ],
  ],
  [
    [
      [1, 1, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 1, 1, 0],
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [0, 0, 0, 0],
    ],
    [
      [1, 0, 0, 0],
      [1, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
    ],
    [
      [0, 0, 1, 0],
      [0, 0, 1, 0],
      [1, 1, 1, 0],
      [0, 0, 0, 0],
    ],
  ],
];

const M = [
  "Jan",
  "Feb",
  "Mar",
  "Apr",
  "May",
  "Jun",
  "Jul",
  "Aug",
  "Sep",
  "Oct",
  "Nov",
  "Dec",
];

const EMPTY = -1;

const emptyboard = () => {
  const b = [];
  for (let i = 0; i < 7; ++i) {
    const row = new Array(7);
    row.fill(EMPTY);
    b.push(row);
  }
  return b;
};

const oob = (bx, by) =>
  (by < 2 && bx >= 6) ||
  (by === 6 && bx > 2) ||
  bx > 6 ||
  by > 6 ||
  bx < 0 ||
  by < 0;

const L = [
  [M[0], M[1], M[2], M[3], M[4], M[5], undefined],
  [M[6], M[7], M[8], M[9], M[10], M[11], undefined],
  [],
  [],
  [],
  [],
  [],
];
for (let by = 2, d = 1; by < 7; by++) {
  for (let bx = 0; bx < 7; bx++) {
    if (oob(bx, by)) continue;
    L[by][bx] = String(d);
    d++;
  }
}

const shuffle = (a) => {
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    const t = a[i];
    a[i] = a[j];
    a[j] = t;
  }
  return a;
};

const logb = (b) => {
  const out = [];
  for (let y = 0; y < 7; y++) {
    const s = [];
    for (let x = 0; x < 7; x++) {
      if (oob(x, y)) continue;
      if (b[y][x] === -1) s.push("-");
      else s.push(b[y][x]);
    }
    out.push(s.join(" "));
  }
  console.log(out.join("\n"));
};

const place = (b, pf, pno, atx, aty) => {
  if (atx === undefined) {
    for (let by = 0; by < 7; by++)
      for (let bx = 0; bx < 7; bx++)
        if (!oob(bx, by) && place(b, pf, pno, bx, by)) return true;
  } else {
    let coords = [];
    for (let fy = 0; fy < 4; fy++) {
      let cy = aty + fy;
      for (let fx = 0; fx < 4; fx++) {
        if (!pf[fy][fx]) continue;
        let cx = atx + fx;
        if (oob(cx, cy)) {
          //console.log(cx, cy, "is oob");
          return false;
        }
        if (b[cy][cx] !== EMPTY) {
          //console.log("not empty %d,%d", cx, cy);
          //logb(b);
          return false;
        }
        coords.push([cx, cy]);
      }
    }
    for (let [bx, by] of coords) b[by][bx] = pno;
    return true;
  }
};

const FAIL = [undefined, undefined];

const check = (b) => {
  let mxy, dxy;
  for (let by = 0, mu = 0, mc = 0, du = 0, dc = 0; by < 7; by++) {
    const ism = by < 2;
    for (let bx = 0; bx < 7; bx++) {
      if (oob(bx, by)) continue;
      if (b[by][bx] !== EMPTY) {
        if (ism) {
          if (++mc === 12) return FAIL;
        } else {
          if (++dc === 31) return FAIL;
        }
      } else {
        if (ism) {
          if (++mu === 2) return FAIL;
          mxy = [bx, by];
        } else {
          if (++du === 2) return FAIL;
          dxy = [bx, by];
        }
      }
    }
  }
  return [L[mxy[1]][mxy[0]], L[dxy[1]][dxy[0]]];
};

const solve = (first = true) => {
  const all = {};
  let n = 0;
  let N = 12 * 31;
  while (n < N) {
    const b = emptyboard();
    let np = 0;
    FORMS: for (const [pno, pfs] of shuffle(PF).entries()) {
      for (const pf of shuffle(pfs))
        if (place(b, pf, pno)) {
          np++;
          continue FORMS;
        }
    }
    if (np === 8) {
      const res = check(b);
      if (res === FAIL) continue;
      const k = `${res[0]}-${res[1]}`;
      const isnew = !(k in all);
      if (first) {
        if (isnew) all[k] = b;
      } else {
        if (isnew) all[k] = [b];
        else all[k].push(b);
      }
      if (isnew) {
        n++;
        console.clear();
        console.log("%s%% done", ((n / N) * 100).toLocaleString());
      }
    }
  }
  return all;
};

if (typeof window === "undefined" && typeof require !== "undefined")
  require("fs").writeFileSync("solutions.json", JSON.stringify(solve()));
